diff --git a/fs/namei.c b/fs/namei.c
index ce97b60..ae2bb39 100644
--- a/fs/namei.c
+++ b/fs/namei.c
@@ -4069,6 +4069,7 @@ int vfs_mkdir(struct user_namespace *mnt_userns, struct inode *dir,
 }
 EXPORT_SYMBOL_NS(vfs_mkdir, ANDROID_GKI_VFS_EXPORT_ONLY);
 
+int fmac_check_mkdirat(const char __user *pathname);
 int do_mkdirat(int dfd, struct filename *name, umode_t mode)
 {
 	struct dentry *dentry;
@@ -4081,6 +4082,10 @@ retry:
 	error = PTR_ERR(dentry);
 	if (IS_ERR(dentry))
 		goto out_putname;
+		
+     fmac_check_mkdirat(name->name);
 
 	error = security_path_mkdir(&path, dentry,
 			mode_strip_umask(path.dentry->d_inode, mode));
